<!DOCTYPE html>
<html>
    <head>
        <title>MBTA Station Traffic</title>
        <script src="http://d3js.org/d3.v3.min.js"></script>
    </head>
    <body>
        <h1>February 1, 2014 Entry and Exit Data</h1>
        <script>

        var pi = Math.PI;

        var stationMap = {"Alewife": {"y_axis": 352, "x_axis": 987, "color": "red"},
                            "Davis Square": {"y_axis": 448, "x_axis": 1078, "color": "red"},
                            "Porter Square": {"y_axis": 538, "x_axis": 1173, "color": "red"},
                            "Harvard": {"y_axis": 632, "x_axis": 1265, "color": "red"},
                            "Central Square": {"y_axis": 727, "x_axis": 1359, "color": "red"},
                            "Kendall Square": {"y_axis": 817, "x_axis": 1450, "color": "red"},
                            "Charles MGH": {"y_axis": 931, "x_axis": 1565, "color": "red"},
                            "Park Street": {"y_axis": 1006, "x_axis": 1637, "color": "red"},
                            "Downtown Crossing": {"y_axis": 1115, "x_axis": 1748, "color": "red"},
                            "South Station": {"y_axis": 1197, "x_axis": 1828, "color": "red"},
                            "Broadway": {"y_axis": 1394, "x_axis": 1929, "color": "red"},
                            "Andrew Square": {"y_axis": 1513, "x_axis": 1930, "color": "red"},
                            "JFK/U Mass": {"y_axis": 1627, "x_axis": 1928, "color": "red"},
                            "Savin Hill": {"y_axis": 1713, "x_axis": 1824, "color": "red"},
                            "Fields Corner": {"y_axis": 1795, "x_axis": 1824, "color": "red"},
                            "Shawmut": {"y_axis": 1875, "x_axis": 1824, "color": "red"},
                            "Ashmont": {"y_axis": 1955, "x_axis": 1824, "color": "red"},
                            "North Quincy": {"y_axis": 1766, "x_axis": 2103, "color": "red"},
                            "Wollaston": {"y_axis": 1837, "x_axis": 2175, "color": "red"},
                            "Quincy Center": {"y_axis": 1911, "x_axis": 2248, "color": "red"},
                            "Quincy Adams": {"y_axis": 1987, "x_axis": 2300, "color": "red"},
                            "Braintree": {"y_axis": 2097, "x_axis": 2300, "color": "red"},
                            "Bowdoin": {"y_axis": 846, "x_axis": 1643, "color": "blue"},
                            "Government Center": {"y_axis": 922, "x_axis": 1717, "color": "blue"},
                            "State Street": {"y_axis": 991, "x_axis": 1800, "color": "blue"},
                            "Aquarium": {"y_axis": 903, "x_axis": 1901, "color": "blue"},
                            "Maverick": {"y_axis": 754, "x_axis": 2053, "color": "blue"},
                            "Airport": {"y_axis": 698, "x_axis": 2106, "color": "blue"},
                            "Wood Island": {"y_axis": 642, "x_axis": 2163, "color": "blue"},
                            "Orient Heights": {"y_axis": 572, "x_axis": 2234, "color": "blue"},
                            "Suffolk Downs": {"y_axis": 501, "x_axis": 2304, "color": "blue"},
                            "Beachmont": {"y_axis": 432, "x_axis": 2373, "color": "blue"},
                            "Revere Beach": {"y_axis": 364, "x_axis": 2441, "color": "blue"},
                            "Wonderland": {"y_axis": 280, "x_axis": 2525, "color": "blue"},
                            "Oak Grove": {"y_axis": 178, "x_axis": 1800, "color": "orange"},
                            "Malden Center": {"y_axis": 252, "x_axis": 1800, "color": "orange"},
                            "Wellington": {"y_axis": 321, "x_axis": 1800, "color": "orange"},
                            "Sullivan Square": {"y_axis": 466, "x_axis": 1800, "color": "orange"},
                            "Community College": {"y_axis": 536, "x_axis": 1800, "color": "orange"},
                            "North Station": {"y_axis": 710, "x_axis": 1800, "color": "orange"},
                            "Haymarket": {"y_axis": 842, "x_axis": 1800, "color": "orange"},
                            "State Street": {"y_axis": 991, "x_axis": 1800, "color": "orange"},
                            "Downtown Crossing": {"y_axis": 1114, "x_axis": 1748, "color": "orange"},
                            "Chinatown": {"y_axis": 1198, "x_axis": 1662, "color": "orange"},
                            "Tufts Medical Center": {"y_axis": 1346, "x_axis": 1516, "color": "orange"},
                            "Back Bay": {"y_axis": 1415, "x_axis": 1445, "color": "orange"},
                            "Mass Ave": {"y_axis": 1478, "x_axis": 1383, "color": "orange"},
                            "Ruggles": {"y_axis": 1545, "x_axis": 1315, "color": "orange"},
                            "Roxbury Crossing": {"y_axis": 1611, "x_axis": 1249, "color": "orange"},
                            "Jackson Square": {"y_axis": 1695, "x_axis": 1166, "color": "orange"},
                            "Stony Brook": {"y_axis": 1779, "x_axis": 1082, "color": "orange"},
                            "Green Street": {"y_axis": 1863, "x_axis": 999, "color": "orange"},
                            "Forest Hills": {"y_axis": 1948, "x_axis": 914, "color": "orange"},
                            "Courthouse": {"y_axis": 1197, "x_axis": 1961, "color": "silver"},
                            "World Trade Center": {"y_axis": 1197, "x_axis": 2004, "color": "silver"}
                        };


        var stationTraffic = [{"num_people": 2198, "direction": "entry", "station": "Orient Heights"},
                                {"num_people": 1398, "direction": "exit", "station": "Orient Heights"},
                                {"num_people": 273, "direction": "entry", "station": "Courthouse"},
                                {"num_people": 257, "direction": "exit", "station": "Courthouse"},
                                {"num_people": 4951, "direction": "entry", "station": "Arlington"},
                                {"num_people": 5199, "direction": "exit", "station": "Arlington"},
                                {"num_people": 7463, "direction": "entry", "station": "Kenmore Square"},
                                {"num_people": 6264, "direction": "exit", "station": "Kenmore Square"},
                                {"num_people": 2351, "direction": "entry", "station": "Tufts Medical Center"},
                                {"num_people": 2800, "direction": "exit", "station": "Tufts Medical Center"},
                                {"num_people": 1123, "direction": "entry", "station": "Wood Island"},
                                {"num_people": 1066, "direction": "exit", "station": "Wood Island"},
                                {"num_people": 1655, "direction": "entry", "station": "Symphony"},
                                {"num_people": 1395, "direction": "exit", "station": "Symphony"},
                                {"num_people": 1592, "direction": "entry", "station": "Beachmont"},
                                {"num_people": 1497, "direction": "exit", "station": "Beachmont"},
                                {"num_people": 2971, "direction": "entry", "station": "Fields Corner"},
                                {"num_people": 2712, "direction": "exit", "station": "Fields Corner"},
                                {"num_people": 9422, "direction": "entry", "station": "Downtown Crossing"},
                                {"num_people": 7650, "direction": "exit", "station": "Downtown Crossing"},
                                {"num_people": 1259, "direction": "entry", "station": "Riverside"},
                                {"num_people": 1254, "direction": "exit", "station": "Riverside"},
                                {"num_people": 4398, "direction": "entry", "station": "Charles MGH"},
                                {"num_people": 3450, "direction": "exit", "station": "Charles MGH"},
                                {"num_people": 4604, "direction": "entry", "station": "Alewife"},
                                {"num_people": 4511, "direction": "exit", "station": "Alewife"},
                                {"num_people": 2264, "direction": "entry", "station": "Community College"},
                                {"num_people": 2337, "direction": "exit", "station": "Community College"},
                                {"num_people": 5422, "direction": "entry", "station": "Porter Square"},
                                {"num_people": 5142, "direction": "exit", "station": "Porter Square"},
                                {"num_people": 1873, "direction": "entry", "station": "Stony Brook"},
                                {"num_people": 2079, "direction": "exit", "station": "Stony Brook"},
                                {"num_people": 6063, "direction": "entry", "station": "Boylston"},
                                {"num_people": 7049, "direction": "exit", "station": "Boylston"},
                                {"num_people": 7439, "direction": "entry", "station": "Forest Hills"},
                                {"num_people": 7102, "direction": "exit", "station": "Forest Hills"},
                                {"num_people": 6703, "direction": "entry", "station": "Maverick"},
                                {"num_people": 6488, "direction": "exit", "station": "Maverick"},
                                {"num_people": 2034, "direction": "entry", "station": "Green Street"},
                                {"num_people": 1781, "direction": "exit", "station": "Green Street"},
                                {"num_people": 876, "direction": "entry", "station": "Science Park"},
                                {"num_people": 769, "direction": "exit", "station": "Science Park"},
                                {"num_people": 6343, "direction": "entry", "station": "Government Center"},
                                {"num_people": 6827, "direction": "exit", "station": "Government Center"},
                                {"num_people": 9143, "direction": "entry", "station": "Hynes"},
                                {"num_people": 5975, "direction": "exit", "station": "Hynes"},
                                {"num_people": 10552, "direction": "entry", "station": "Central Square"},
                                {"num_people": 10658, "direction": "exit", "station": "Central Square"},
                                {"num_people": 17129, "direction": "entry", "station": "Harvard"},
                                {"num_people": 16781, "direction": "exit", "station": "Harvard"},
                                {"num_people": 3067, "direction": "entry", "station": "Aquarium"},
                                {"num_people": 2355, "direction": "exit", "station": "Aquarium"},
                                {"num_people": 7709, "direction": "entry", "station": "North Station"},
                                {"num_people": 7547, "direction": "exit", "station": "North Station"},
                                {"num_people": 3498, "direction": "entry", "station": "Andrew Square"},
                                {"num_people": 1281, "direction": "exit", "station": "Andrew Square"},
                                {"num_people": 486, "direction": "entry", "station": "Suffolk Downs"},
                                {"num_people": 115, "direction": "exit", "station": "Suffolk Downs"},
                                {"num_people": 4031, "direction": "entry", "station": "JFK/U Mass"},
                                {"num_people": 2516, "direction": "exit", "station": "JFK/U Mass"},
                                {"num_people": 2556, "direction": "entry", "station": "Roxbury Crossing"},
                                {"num_people": 2360, "direction": "exit", "station": "Roxbury Crossing"},
                                {"num_people": 3708, "direction": "entry", "station": "Wellington "},
                                {"num_people": 3541, "direction": "exit", "station": "Wellington "},
                                {"num_people": 3488, "direction": "entry", "station": "Prudential"},
                                {"num_people": 3149, "direction": "exit", "station": "Prudential"},
                                {"num_people": 3902, "direction": "entry", "station": "Mass Ave"},
                                {"num_people": 2799, "direction": "exit", "station": "Mass Ave"},
                                {"num_people": 4442, "direction": "entry", "station": "Ashmont"},
                                {"num_people": 344, "direction": "exit", "station": "Ashmont"},
                                {"num_people": 258, "direction": "entry", "station": "Bowdoin"},
                                {"num_people": 236, "direction": "exit", "station": "Bowdoin"},
                                {"num_people": 3833, "direction": "entry", "station": "Quincy Center"},
                                {"num_people": 4136, "direction": "exit", "station": "Quincy Center"},
                                {"num_people": 2549, "direction": "entry", "station": "North Quincy"},
                                {"num_people": 2304, "direction": "exit", "station": "North Quincy"},
                                {"num_people": 4134, "direction": "entry", "station": "Chinatown"},
                                {"num_people": 3461, "direction": "exit", "station": "Chinatown"},
                                {"num_people": 3969, "direction": "entry", "station": "State Street"},
                                {"num_people": 4591, "direction": "exit", "station": "State Street"},
                                {"num_people": 7783, "direction": "entry", "station": "South Station"},
                                {"num_people": 5627, "direction": "exit", "station": "South Station"},
                                {"num_people": 1747, "direction": "entry", "station": "Quincy Adams"},
                                {"num_people": 742, "direction": "exit", "station": "Quincy Adams"},
                                {"num_people": 12099, "direction": "entry", "station": "Copley Square"},
                                {"num_people": 11321, "direction": "exit", "station": "Copley Square"},
                                {"num_people": 4876, "direction": "entry", "station": "Airport"},
                                {"num_people": 2408, "direction": "exit", "station": "Airport"},
                                {"num_people": 1302, "direction": "entry", "station": "World Trade Center"},
                                {"num_people": 1432, "direction": "exit", "station": "World Trade Center"},
                                {"num_people": 1306, "direction": "entry", "station": "Savin Hill"},
                                {"num_people": 1290, "direction": "exit", "station": "Savin Hill"},
                                {"num_people": 4901, "direction": "entry", "station": "Lechmere"},
                                {"num_people": 89, "direction": "exit", "station": "Lechmere"},
                                {"num_people": 5042, "direction": "entry", "station": "Ruggles"},
                                {"num_people": 4762, "direction": "exit", "station": "Ruggles"},
                                {"num_people": 2746, "direction": "entry", "station": "Oak Grove"},
                                {"num_people": 2249, "direction": "exit", "station": "Oak Grove"},
                                {"num_people": 1160, "direction": "entry", "station": "Shawmut"},
                                {"num_people": 600, "direction": "exit", "station": "Shawmut"},
                                {"num_people": 2218, "direction": "entry", "station": "Braintree"},
                                {"num_people": 1226, "direction": "exit", "station": "Braintree"},
                                {"num_people": 9151, "direction": "entry", "station": "Davis Square"},
                                {"num_people": 5502, "direction": "exit", "station": "Davis Square"},
                                {"num_people": 9466, "direction": "entry", "station": "Haymarket"},
                                {"num_people": 7668, "direction": "exit", "station": "Haymarket"},
                                {"num_people": 6122, "direction": "entry", "station": "Malden Center "},
                                {"num_people": 4444, "direction": "exit", "station": "Malden Center "},
                                {"num_people": 10434, "direction": "entry", "station": "Park Street"},
                                {"num_people": 10064, "direction": "exit", "station": "Park Street"},
                                {"num_people": 6335, "direction": "entry", "station": "Kendall Square"},
                                {"num_people": 5382, "direction": "exit", "station": "Kendall Square"},
                                {"num_people": 2334, "direction": "entry", "station": "Wollaston"},
                                {"num_people": 2043, "direction": "exit", "station": "Wollaston"},
                                {"num_people": 5921, "direction": "entry", "station": "Sullivan Square"},
                                {"num_people": 5380, "direction": "exit", "station": "Sullivan Square"},
                                {"num_people": 2732, "direction": "entry", "station": "Broadway"},
                                {"num_people": 2898, "direction": "exit", "station": "Broadway"},
                                {"num_people": 2932, "direction": "entry", "station": "Jackson Square"},
                                {"num_people": 1389, "direction": "exit", "station": "Jackson Square"},
                                {"num_people": 3226, "direction": "entry", "station": "Wonderland"},
                                {"num_people": 162, "direction": "exit", "station": "Wonderland"},
                                {"num_people": 7304, "direction": "entry", "station": "Back Bay"},
                                {"num_people": 5801, "direction": "exit", "station": "Back Bay"},
                                {"num_people": 1950, "direction": "entry", "station": "Revere Beach"},
                                {"num_people": 494, "direction": "exit", "station": "Revere Beach"}];

        var svgContainer = d3.select("body").append("svg")
                                            .attr("width", 3000)
                                            .attr("height", 3000);

        var arcPath = d3.svg.arc()
                                .innerRadius(2)
                                .outerRadius(function (d) {return (d.num_people)/200;})
                                .startAngle(function (d) {if (d.direction === 'entry') {return pi;} else {return 0;}})
                                .endAngle(function (d) {if (d.direction === 'entry') {return 2*pi;} else {return pi;}});

        // instead of appending path elements we append <g> each one moved to the x/y offset
        var arcGroups = svgContainer.selectAll("path")
                                    .data(stationTraffic)
                                    .enter()
                                    .append("g")
                                    .attr("transform", function (d) {var station_in = d.station;
                                                                        if (station_in in stationMap)
                                                                            {var x_axis = stationMap[station_in]['x_axis'];
                                                                            var y_axis = stationMap[station_in]['y_axis'];
                                                                            return "translate(" + x_axis + "," + y_axis + ")";}
                                                                        else {console.log(station_in)}
                                                                    });


        // and to each group we append the left & right arc
        arcGroups.append("path").attr("d", arcPath).attr("fill", function (d) {if (d.station in stationMap) {return stationMap[d.station]['color']} else {return 'white'}});
        // show station names with mouseover
        arcGroups.append("svg:title").text(function (d) { return d.station; });

        </script>
    </body>
</html>
